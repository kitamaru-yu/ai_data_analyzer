# 🏢 企業データ分析システム - 使用ガイド

AI を活用した高度なデータ分析と戦略提案システムの使用方法

![System Demo](https://img.shields.io/badge/Status-Ready-green) ![Python](https://img.shields.io/badge/Python-3.8+-blue) ![Streamlit](https://img.shields.io/badge/Streamlit-Ready-red)

## 🚀 クイック起動

### 🎯 最も簡単な方法
```
🚀 START_GUI.bat をダブルクリック
```
美しいGUIランチャーが起動し、ブラウザで分析システムが開きます

### 🌐 Web版を直接起動
```
📊 START_WEB.bat をダブルクリック
```
直接ブラウザで http://localhost:8501 が開きます

## ✨ 主な機能

### 📊 データ分析
- **基本統計分析**: データの概要、分布、傾向を把握
- **相関分析**: 変数間の関係性を発見
- **時系列分析**: 時間的な変化とトレンドを分析
- **外れ値検出**: 異常値や特異なパターンを特定

### 🎨 データ可視化
- **インタラクティブグラフ**: Plotlyを使用した高度な可視化
- **統計チャート**: 分布図、散布図、相関マップ
- **ダッシュボード**: エグゼクティブ向け総合ダッシュボード

### 🤖 AI 戦略提案
- **データ洞察**: AIによる自動的な洞察抽出
- **戦略提案**: ビジネス改善のための具体的な提案
- **次のアクション**: 実行可能な行動計画

## 🔧 対応AIモデル

| モデル | 特徴 | 推奨用途 |
|--------|------|----------|
| **GPT-4.1** | 最新高性能 | 重要分析 |
| **GPT-4o** | 最適化済み | 総合分析 |
| **GPT-4 Turbo** | 高速バランス | 一般分析 |
| **GPT-3.5 Turbo** | 経済的 | 大量処理 |

## 📝 簡単3ステップ

1. **🚀 START_GUI.bat** をダブルクリック
2. **📤 CSVファイル** をアップロード
3. **🤖 AI分析** を実行して結果を確認

## 📋 詳細な使用手順

### Step 1: システム起動
1. `🚀 START_GUI.bat` をダブルクリック
2. GUIランチャーで「🚀 GUI アプリケーションを起動」をクリック
3. ブラウザで http://localhost:8501 が自動的に開く

### Step 2: 設定
1. **API Key設定**: 左サイドバーでOpenAI API Keyを入力
2. **モデル選択**: 用途に応じてAIモデルを選択
   - バランス重視 → GPT-4o
   - 高品質 → GPT-4.1
   - コスト重視 → GPT-3.5 Turbo
   - 高速 → GPT-4o Mini

### Step 3: データアップロード
1. **CSVファイル**: 左サイドバーからCSVファイルを選択
2. **テキストファイル（オプション）**: 追加の市場情報等をアップロード
3. **データ確認**: アップロード後、データ概要を確認

### Step 4: 分析実行
1. **基本分析**: 「基本分析を実行」ボタンをクリック
2. **可視化**: 「可視化を生成」で グラフを作成
3. **AI分析**: 「AI分析を実行」で洞察を取得
4. **戦略提案**: 「戦略提案を生成」でビジネス提案を取得

### Step 5: 結果確認・ダウンロード
1. **分析結果**: タブで各種分析結果を確認
2. **グラフ**: インタラクティブなグラフで詳細確認
3. **レポート**: 「📄 レポートダウンロード」でMarkdown形式でダウンロード

## 📁 ファイル構造

```
📦 企業データ分析システム/
├── 🚀 START_GUI.bat          # メイン起動ファイル
├── 📊 START_WEB.bat          # Web版起動ファイル
├── 📋 main.py                # プログラムエントリー
├── 🔧 .env                   # 設定ファイル
├── 📁 src/                   # プログラムソース
│   ├── core/                 # コアモジュール
│   └── ui/                   # UIモジュール
├── 📁 data/                  # サンプルデータ
├── 📁 docs/                  # ドキュメント
├── 📁 tests/                 # テストコード
└── 📁 launchers/             # 起動スクリプト
```

## 💡 Tips & ベストプラクティス

### 📊 データ準備
- **CSVフォーマット**: ヘッダー行を含む標準的なCSV形式
- **データサイズ**: 推奨は10MB以下、大きなファイルは分割
- **列名**: 英語または日本語（スペースは避ける）
- **欠損値**: 空欄またはNULLで表現

### 🤖 モデル選択指針
- **重要な戦略分析**: GPT-4.1, GPT-4
- **日常的な分析**: GPT-4o, GPT-4 Turbo  
- **大量データ処理**: GPT-3.5 Turbo
- **プロトタイプ**: GPT-4o Mini

### 🎨 可視化活用
- **分布図**: データの概要把握
- **相関図**: 変数間の関係性発見
- **時系列**: トレンド分析
- **ダッシュボード**: 経営報告用

## 🔍 トラブルシューティング

### 🆘 よくある問題

#### 起動しない場合
1. **仮想環境確認**: `.venv` フォルダが存在するか
2. **依存関係**: `pip install -r requirements.txt` を実行
3. **Python版**: Python 3.8以上がインストールされているか

#### API Key エラー
1. **正しいキー**: OpenAI Platformで取得したキーか確認
2. **環境変数**: `.env` ファイルまたはUI直接入力
3. **クレジット**: OpenAIアカウントにクレジットがあるか

#### メモリ不足
1. **ファイルサイズ**: CSVファイルを10MB以下に分割
2. **ブラウザ**: ブラウザのキャッシュをクリア
3. **再起動**: システムを再起動

#### パフォーマンス問題
1. **モデル変更**: 軽量モデル（GPT-3.5 Turbo）に変更
2. **データ削減**: 分析対象データを絞り込み
3. **バックグラウンド**: 他のアプリケーションを終了

## 📞 サポート

### 🔧 システム診断
1. **状態確認**: `launchers\GUI_Launcher.bat` → 「システム状態を確認」
2. **テスト実行**: `launchers\run_tests.bat` で動作確認
3. **ログ確認**: コンソール出力でエラーメッセージ確認

### 📚 追加リソース
- **技術詳細**: [docs/README.md](README.md) の技術ドキュメント
- **サンプルデータ**: `data/` フォルダ内のサンプルファイル
- **テストコード**: `tests/` フォルダで動作例を確認

## 🌟 高度な使用方法

### 🔧 カスタマイズ
- **モデル設定**: `.env` ファイルでデフォルトモデルを変更
- **トークン数**: 分析の詳細度を調整
- **温度パラメータ**: AI回答の創造性を調整

### 📊 バッチ処理
- **複数ファイル**: 順次処理でバッチ分析
- **定期実行**: スケジューラーでの自動実行
- **結果統合**: 複数結果の統合分析

### 🎨 レポート活用
- **Markdown**: テキストエディタで編集可能
- **プレゼン**: パワーポイント等にコピー&ペースト
- **共有**: チーム内での結果共有

---

**🎯 今すぐ始める**: `🚀 START_GUI.bat` をダブルクリック！

**📚 詳細情報**: [技術ドキュメント](README.md)

### 可視化機能
- ✅ 相関行列ヒートマップ
- ✅ 分布図・ヒストグラム
- ✅ 散布図・箱ひげ図
- ✅ カテゴリ分析・棒グラフ
- ✅ トレンド分析・線グラフ
- ✅ AI推奨の統合可視化

### ビジネス戦略提案
- ✅ 現状課題・機会の特定
- ✅ 優先度付き行動計画
- ✅ メリット・デメリット・リスク分析
- ✅ 数値目標・KPI設定
- ✅ 短期・中期・長期ロードマップ

## 🎯 使用例

### サンプルデータでの分析
```bash
# 1. システム起動
python main.py

# 2. サンプルファイルを使用
CSVファイルのパス: business_data.csv
テキストファイル: market_context.txt

# 3. 分析実行
1. データ構造分析
2. AI詳細分析
3. データ可視化
4. ビジネス戦略提案
```

### 実際の企業データ分析
```bash
# 1. 企業データを準備（CSV形式）
# 推奨列: Company, Revenue, Employees, Industry, Profit, Growth_Rate など

# 2. 業界コンテキストを準備（テキストファイル）
# 市場動向、競合状況、規制環境等の情報

# 3. システムで分析実行
```

## 📋 分析結果の活用

### 1. データ理解フェーズ
- データ構造分析で品質確認
- 欠損値・異常値の特定
- 基本統計量の確認

### 2. パターン発見フェーズ
- 相関分析で関係性発見
- 分布分析で特徴把握
- カテゴリ分析で分類理解

### 3. インサイト抽出フェーズ
- AI分析で深い洞察獲得
- 可視化で直感的理解
- トレンド分析で時系列パターン発見

### 4. 戦略立案フェーズ
- 現状課題の明確化
- 機会の特定と優先度設定
- 具体的行動計画の策定

## 🔧 カスタマイズ

### プロンプトの調整
```python
# AI分析のプロンプトをカスタマイズ
custom_prompt = """
あなたの業界に特化した分析観点を追加
- 業界特有の指標
- 競合分析の観点
- 規制環境の考慮
"""
analyzer.ai_analyze_data(custom_prompt)
```

### 可視化のカスタマイズ
```python
# 特定の可視化を指定
visualizations = analyzer.create_visualizations(
    chart_type='scatter',
    columns=['Revenue', 'Profit']
)
```

## 💡 ベストプラクティス

### データ準備
- ✅ 列名は英語で統一
- ✅ 数値データは数値型で保存
- ✅ カテゴリデータは文字列型で保存
- ✅ 欠損値は適切に処理

### 分析アプローチ
- ✅ まず基本的な構造分析から開始
- ✅ 可視化で全体像を把握
- ✅ AI分析で詳細な洞察を獲得
- ✅ 戦略提案で実行可能性を検討

### 結果の活用
- ✅ 複数の角度から分析
- ✅ 定量的・定性的両面で評価
- ✅ 短期・長期の影響を考慮
- ✅ 実装可能性を重視

## 🚨 注意事項

### API使用料金
- GPT-4使用時は特に料金に注意
- 大量データ処理時は事前に見積もり
- APIキーの使用量制限を確認

### データセキュリティ
- 機密データの取り扱いに注意
- 必要に応じてローカル環境で実行
- APIに送信するデータ量を制限

### 分析結果の解釈
- AIの提案は参考として活用
- 実際のビジネス判断は人間が行う
- 複数の分析結果を総合的に評価

## 🆘 トラブルシューティング

### よくある問題

**1. API Key エラー**
```
解決方法: .envファイルのAPIキーを確認
```

**2. パッケージインストールエラー**
```
解決方法: pip install --upgrade pip
```

**3. 日本語文字化け**
```
解決方法: CSVファイルをUTF-8で保存
```

**4. メモリ不足**
```
解決方法: データサイズを小さくするか、処理を分割
```

### サポート情報
- GitHub Issues で質問可能
- README.md に詳細な技術情報
- サンプルデータで動作確認

## 🔄 アップデート情報

### v1.0.0 (現在)
- 基本的な分析・可視化機能
- ビジネス戦略提案機能
- WebアプリケーションUI
- 包括的なレポート生成

### 今後の予定
- 時系列分析機能の追加
- 機械学習モデルの統合
- 業界別テンプレートの提供
- リアルタイムデータ連携

このシステムを使用して、データドリブンな企業経営を実現してください！
