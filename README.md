# 企業データ分析・可視化・戦略提案システム

企業データ（CSV）とテキスト情報を読み込み、OpenAI APIを使用して包括的な分析・可視化・戦略提案を行うシステムです。

## 機能

### 1. データ分析機能
- **CSVファイル読み込み**: 企業データの自動読み込みと構造分析
- **テキストファイル読み込み**: 追加のコンテキスト情報の取り込み
- **AI分析**: OpenAI GPT-4を使用した詳細なデータ分析
- **統計分析**: 基本統計量、相関分析、異常値検出

### 2. データ可視化機能
- **相関行列**: 数値データ間の相関関係を視覚化
- **分布図**: 各変数の分布パターンを表示
- **散布図**: 変数間の関係性を可視化
- **棒グラフ**: カテゴリデータの分布を表示
- **線グラフ**: トレンド分析
- **AI推奨グラフ**: 最適な可視化を自動選択

### 3. ビジネス戦略提案機能
- **現状分析**: データから読み取れる現状の課題・機会を特定
- **行動計画**: 具体的で実行可能な戦略を優先度付きで提案
- **リスク分析**: メリット・デメリット・懸念点を詳細に分析
- **成果予測**: 期待される数値目標とKPIを設定
- **ロードマップ**: 短期・中期・長期の戦略計画を策定

### 4. レポート機能
- **分析レポート**: 全分析結果を統合したレポート生成
- **結果保存**: CSVファイルとしてデータ保存
- **可視化出力**: HTML形式のインタラクティブグラフ

## セットアップ

1. 必要なパッケージをインストール:
```bash
pip install -r requirements.txt
```

2. `.env`ファイルにOpenAI API keyを設定:
```
OPENAI_API_KEY=your_actual_api_key_here
```

## 使用方法

1. システムを実行:
```bash
python main.py
```

2. CSVファイルのパスを入力（サンプル: `business_data.csv`）

3. 追加のテキストファイルを読み込み（オプション）

4. メニューから実行したい機能を選択:
   - **データ構造分析**: 基本的なデータ構造と品質を確認
   - **AI詳細分析**: GPT-4による包括的な分析
   - **データ可視化**: 各種グラフの作成
   - **可視化インサイト**: グラフから読み取れる洞察の分析
   - **ビジネス戦略提案**: 具体的な行動計画の提案
   - **レポート保存**: 分析結果の統合レポート作成

## ファイル構成

- `main.py`: メインプログラム
- `requirements.txt`: 必要なパッケージ一覧
- `.env`: OpenAI API keyの設定ファイル
- `business_data.csv`: 企業データのサンプル
- `market_context.txt`: 市場環境の追加情報
- `sample_data.csv`: 基本的なサンプルデータ

## 出力ファイル

### 可視化ファイル
- `correlation_matrix.png`: 相関行列ヒートマップ
- `distributions.png`: 分布図
- `scatter_plot.html`: インタラクティブ散布図
- `bar_chart.html`: 棒グラフ
- `line_chart.html`: 線グラフ
- `ai_recommended_charts.html`: AI推奨の統合グラフ

### レポートファイル
- `analysis_report.txt`: 統合分析レポート

## 使用例

### 基本的な分析フロー
```python
# システム初期化
analyzer = BusinessDataAnalyzer()

# データ読み込み
df = analyzer.read_csv('business_data.csv')
analyzer.read_text_file('market_context.txt')

# 分析実行
structure = analyzer.analyze_data_structure()
ai_analysis = analyzer.ai_analyze_data()

# 可視化
visualizations = analyzer.create_visualizations(chart_type='auto')

# 戦略提案
strategy = analyzer.generate_business_strategy()
```

### 実際の企業データ分析例

サンプルデータ（15社の企業データ）を使用した分析例：

**分析対象指標:**
- 売上高 (Revenue)
- 従業員数 (Employees)
- 業界 (Industry)
- 利益 (Profit)
- 市場シェア (Market_Share)
- 顧客満足度 (Customer_Satisfaction)
- 成長率 (Growth_Rate)

**期待される分析結果:**
- 業界別パフォーマンス比較
- 成長率と利益率の相関分析
- 顧客満足度と売上の関係性
- 市場シェア拡大の戦略提案

## 注意事項

- OpenAI APIの使用には料金が発生します
- GPT-4使用時は特に料金にご注意ください
- APIキーは安全に管理してください
- 大量のデータ処理時はAPI利用制限にご注意ください
- 実際の企業データを使用する場合は、データの機密性にご注意ください

## システムの特徴

1. **包括的分析**: データの読み込みから戦略提案まで一貫したフロー
2. **AI活用**: 最新のGPT-4を使用した高度な分析
3. **可視化重視**: 多様なグラフによる直感的な理解
4. **実用性**: 実際のビジネス現場で使用可能な具体的提案
5. **拡張性**: 新しい分析手法や可視化手法の追加が容易

このシステムは、企業のデータドリブンな意思決定を支援し、競争優位性の獲得に貢献します。
